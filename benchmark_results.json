[
  {
    "question": "What are the top 5 products with the highest average order value for customers in the United States?",
    "success": false,
    "sql": "SELECT p.name, AVG(oi.quantity * p.price) AS average_order_value\nFROM order_items oi\nJOIN orders o ON oi.order_id = o.id\nJOIN customers c ON o.customer_id = c.id\nJOIN products p ON oi.product_id = p.id\nWHERE c.country = 'United States'\nGROUP BY p.name\nORDER BY average_order_value DESC\nLIMIT 5",
    "error": "Persistent Error: Error: no such column: c.country"
  },
  {
    "question": "What is the total revenue generated from orders placed by customers in the 25-44 age group in the last quarter?",
    "success": false,
    "sql": "SELECT SUM(oi.quantity * p.price) \nFROM order_items oi \nJOIN orders o ON oi.order_id = o.id \nJOIN customers c ON o.customer_id = c.id \nJOIN products p ON oi.product_id = p.id \nWHERE c.age BETWEEN 25 AND 44 \nAND o.order_date >= DATE('now', '-3 month')",
    "error": "Persistent Error: Error: no such column: c.age"
  },
  {
    "question": "List the top 10 customers who have placed the most orders in the last 6 months, along with their total order value.",
    "success": true,
    "sql": "SELECT T1.customer_id, SUM(T3.price * T2.quantity) AS total_order_value\nFROM orders T1\nJOIN order_items T2 ON T1.id = T2.order_id\nJOIN products T3 ON T2.product_id = T3.id\nWHERE T1.order_date >= DATE('now', '-6 months')\nGROUP BY T1.customer_id\nORDER BY total_order_value DESC\nLIMIT 10",
    "error": null
  },
  {
    "question": "What is the average order value for customers who have purchased products from the 'Electronics' category?",
    "success": true,
    "sql": "SELECT AVG(T1.total_order_value) \nFROM (\n    SELECT O.id, SUM(P.price * OI.quantity) AS total_order_value\n    FROM orders O\n    JOIN order_items OI ON O.id = OI.order_id\n    JOIN products P ON OI.product_id = P.id\n    WHERE P.category = 'Electronics'\n    GROUP BY O.id\n) T1",
    "error": null
  },
  {
    "question": "Which product has the highest sales count for orders placed in the 'Pending' status?",
    "success": true,
    "sql": "SELECT p.name, SUM(oi.quantity) as sales_count\nFROM order_items oi\nJOIN orders o ON oi.order_id = o.id\nJOIN products p ON oi.product_id = p.id\nWHERE o.status = 'Pending'\nGROUP BY p.name\nORDER BY sales_count DESC\nLIMIT 1",
    "error": null
  },
  {
    "question": "What is the total number of orders placed by customers from the 'Europe' region in the last year?",
    "success": true,
    "sql": "SELECT COUNT(o.id) \nFROM orders o \nJOIN customers c ON o.customer_id = c.id \nWHERE c.region = 'Europe' \nAND o.order_date >= DATE('now', '-1 year')",
    "error": null
  },
  {
    "question": "Rank the top 3 products by their total revenue generated from orders placed in the last 3 months.",
    "success": true,
    "sql": "SELECT product_id, SUM(quantity * price) AS total_revenue\nFROM order_items\nJOIN orders ON order_items.order_id = orders.id\nJOIN products ON order_items.product_id = products.id\nWHERE orders.order_date >= DATE('now', '-3 months')\nGROUP BY product_id\nORDER BY total_revenue DESC\nLIMIT 3",
    "error": null
  },
  {
    "question": "What is the average customer rating for products from the 'Fashion' category?",
    "success": false,
    "sql": "SELECT AVG(T1.rating) FROM (SELECT T2.id, T2.category, T3.rating FROM products AS T1 INNER JOIN order_items AS T2 ON T1.id = T2.product_id INNER JOIN orders AS T3 ON T2.order_id = T3.id) AS T1 WHERE T1.category = 'Fashion'",
    "error": "Persistent Error: Error: no such column: T2.id"
  },
  {
    "question": "List the top 5 customers who have spent the most on products from the 'Home' category.",
    "success": true,
    "sql": "SELECT T1.customer_id, SUM(T3.price * T2.quantity) AS total_spent\nFROM orders AS T1\nJOIN order_items AS T2 ON T1.id = T2.order_id\nJOIN products AS T3 ON T2.product_id = T3.id\nWHERE T3.category = 'Home'\nGROUP BY T1.customer_id\nORDER BY total_spent DESC\nLIMIT 5",
    "error": null
  },
  {
    "question": "What is the total revenue generated from orders placed by customers who have a 'Gold' loyalty status?",
    "success": false,
    "sql": "SELECT SUM(oi.quantity * p.price) \nFROM order_items oi \nJOIN orders o ON oi.order_id = o.id \nJOIN customers c ON o.customer_id = c.id \nJOIN products p ON oi.product_id = p.id \nWHERE c.status = 'Gold'",
    "error": "Persistent Error: Error: no such column: c.status"
  },
  {
    "question": "What are the top 10 products with the highest sales count for orders placed in the 'Shipped' status?",
    "success": true,
    "sql": "SELECT product_id, SUM(quantity) as sales_count\nFROM order_items\nWHERE order_id IN (SELECT id FROM orders WHERE status = 'Shipped')\nGROUP BY product_id\nORDER BY sales_count DESC\nLIMIT 10",
    "error": null
  },
  {
    "question": "What is the average order value for customers who have purchased products from multiple categories?",
    "success": true,
    "sql": "SELECT AVG(T1.order_value) \nFROM (\n    SELECT O.id, SUM(P.price * OI.quantity) AS order_value\n    FROM orders O\n    JOIN order_items OI ON O.id = OI.order_id\n    JOIN products P ON OI.product_id = P.id\n    GROUP BY O.id\n) T1\nJOIN (\n    SELECT O.id, COUNT(DISTINCT P.category) AS category_count\n    FROM orders O\n    JOIN order_items OI ON O.id = OI.order_id\n    JOIN products P ON OI.product_id = P.id\n    GROUP BY O.id\n    HAVING COUNT(DISTINCT P.category) > 1\n) T2\nON T1.id = T2.id",
    "error": null
  },
  {
    "question": "Which customer has the highest total order value for orders placed in the last 9 months?",
    "success": true,
    "sql": "SELECT T1.id, T1.name, T3.total_order_value\nFROM customers AS T1\nJOIN orders AS T2 ON T1.id = T2.customer_id\nJOIN (\n  SELECT T2.customer_id, SUM(T3.price * T4.quantity) AS total_order_value\n  FROM orders AS T2\n  JOIN order_items AS T4 ON T2.id = T4.order_id\n  JOIN products AS T3 ON T4.product_id = T3.id\n  WHERE T2.order_date > DATE('now', '-9 months')\n  GROUP BY T2.customer_id\n) AS T3 ON T1.id = T3.customer_id\nORDER BY T3.total_order_value DESC\nLIMIT 1",
    "error": null
  },
  {
    "question": "What is the total number of orders placed by customers from the 'Asia' region in the last quarter?",
    "success": true,
    "sql": "SELECT COUNT(o.id) \nFROM orders o \nJOIN customers c ON o.customer_id = c.id \nWHERE c.region = 'Asia' \nAND o.order_date >= DATE('now', '-3 months')",
    "error": null
  },
  {
    "question": "Rank the top 5 products by their average customer rating for orders placed in the last 6 months.",
    "success": false,
    "sql": "SELECT product_id, AVG(customer_rating) as average_rating \nFROM order_items \nJOIN orders ON order_items.order_id = orders.id \nWHERE orders.order_date > DATE('now', '-6 months') \nGROUP BY product_id \nORDER BY average_rating DESC \nLIMIT 5",
    "error": "Persistent Error: Error: no such column: customer_rating"
  },
  {
    "question": "What is the total revenue generated from orders placed by customers who have a 'Silver' loyalty status?",
    "success": false,
    "sql": "SELECT SUM(oi.quantity * p.price) \nFROM order_items oi \nJOIN orders o ON oi.order_id = o.id \nJOIN customers c ON o.customer_id = c.id \nJOIN products p ON oi.product_id = p.id \nWHERE c.status = 'Silver'",
    "error": "Persistent Error: Error: no such column: c.status"
  },
  {
    "question": "What are the top 3 products with the highest sales count for orders placed in the 'Pending' status?",
    "success": true,
    "sql": "SELECT p.name, SUM(oi.quantity) as sales_count\nFROM order_items oi\nJOIN orders o ON oi.order_id = o.id\nJOIN products p ON oi.product_id = p.id\nWHERE o.status = 'Pending'\nGROUP BY p.name\nORDER BY sales_count DESC\nLIMIT 3",
    "error": null
  },
  {
    "question": "What is the average customer rating for products from the 'Electronics' category?",
    "success": false,
    "sql": "SELECT AVG(T1.rating) \nFROM customer_reviews AS T1 \nINNER JOIN products AS T2 \nON T1.product_id = T2.id \nWHERE T2.category = 'Electronics'",
    "error": "Persistent Error: Error: no such table: customer_reviews"
  },
  {
    "question": "List the top 10 customers who have placed the most orders in the last year, along with their total order value.",
    "success": true,
    "sql": "SELECT T1.customer_id, SUM(T3.price * T2.quantity) AS total_order_value\nFROM orders AS T1\nJOIN order_items AS T2 ON T1.id = T2.order_id\nJOIN products AS T3 ON T2.product_id = T3.id\nWHERE T1.order_date >= DATE('now', '-1 year')\nGROUP BY T1.customer_id\nORDER BY total_order_value DESC\nLIMIT 10",
    "error": null
  },
  {
    "question": "What is the total number of orders placed by customers from the 'North America' region in the last 6 months?",
    "success": true,
    "sql": "SELECT COUNT(o.id) \nFROM orders o \nJOIN customers c ON o.customer_id = c.id \nWHERE c.region = 'North America' \nAND o.order_date >= DATE('now', '-6 months')",
    "error": null
  },
  {
    "question": "Rank the top 10 products by their total revenue generated from orders placed in the last 9 months.",
    "success": true,
    "sql": "SELECT product_id, SUM(quantity * price) AS total_revenue\nFROM order_items\nJOIN orders ON order_items.order_id = orders.id\nJOIN products ON order_items.product_id = products.id\nWHERE orders.order_date >= DATE('now', '-9 months')\nGROUP BY product_id\nORDER BY total_revenue DESC\nLIMIT 10",
    "error": null
  },
  {
    "question": "What is the average order value for customers who have purchased products from the 'Fashion' category?",
    "success": true,
    "sql": "SELECT AVG(T1.total_order_value) \nFROM (\n    SELECT O.id, SUM(OI.quantity * P.price) AS total_order_value\n    FROM orders O\n    JOIN order_items OI ON O.id = OI.order_id\n    JOIN products P ON OI.product_id = P.id\n    WHERE P.category = 'Fashion'\n    GROUP BY O.id\n) T1",
    "error": null
  },
  {
    "question": "What are the top 5 customers who have spent the most on products from the 'Electronics' category?",
    "success": true,
    "sql": "SELECT T1.customer_id, SUM(T3.price * T2.quantity) AS total_spent\nFROM orders AS T1\nJOIN order_items AS T2 ON T1.id = T2.order_id\nJOIN products AS T3 ON T2.product_id = T3.id\nWHERE T3.category = 'Electronics'\nGROUP BY T1.customer_id\nORDER BY total_spent DESC\nLIMIT 5",
    "error": null
  },
  {
    "question": "What is the total revenue generated from orders placed by customers who have a 'Bronze' loyalty status?",
    "success": false,
    "sql": "SELECT SUM(oi.quantity * p.price) \nFROM order_items oi \nJOIN orders o ON oi.order_id = o.id \nJOIN customers c ON o.customer_id = c.id \nJOIN products p ON oi.product_id = p.id \nWHERE c.loyalty_status = 'Bronze'",
    "error": "Persistent Error: Error: no such column: c.loyalty_status"
  },
  {
    "question": "What is the average customer rating for products from the 'Home' category?",
    "success": false,
    "sql": "SELECT AVG(T2.rating) \nFROM products AS T1 \nLEFT JOIN order_items AS T3 ON T1.id = T3.product_id \nLEFT JOIN orders AS T4 ON T3.order_id = T4.id \nLEFT JOIN customers AS T5 ON T4.customer_id = T5.id \nLEFT JOIN (SELECT order_id, AVG(rating) as rating FROM customer_ratings GROUP BY order_id) AS T2 ON T4.id = T2.order_id \nWHERE T1.category = 'Home'",
    "error": "Persistent Error: Error: no such table: customer_ratings"
  },
  {
    "question": "List the top 10 products with the highest sales count for orders placed in the 'Shipped' status.",
    "success": true,
    "sql": "SELECT p.id, p.name, SUM(oi.quantity) as sales_count\nFROM order_items oi\nJOIN orders o ON oi.order_id = o.id\nJOIN products p ON oi.product_id = p.id\nWHERE o.status = 'Shipped'\nGROUP BY p.id, p.name\nORDER BY sales_count DESC\nLIMIT 10",
    "error": null
  },
  {
    "question": "What is the total number of orders placed by customers from the 'South America' region in the last quarter?",
    "success": true,
    "sql": "SELECT COUNT(o.id) \nFROM orders o \nJOIN customers c ON o.customer_id = c.id \nWHERE c.region = 'South America' \nAND o.order_date >= DATE('now', '-3 month')",
    "error": null
  },
  {
    "question": "Rank the top 3 customers by their total order value for orders placed in the last 3 months.",
    "success": true,
    "sql": "SELECT c.name, SUM(oi.quantity * p.price) AS total_order_value\nFROM customers c\nJOIN orders o ON c.id = o.customer_id\nJOIN order_items oi ON o.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nWHERE o.order_date > DATE('now', '-3 months')\nGROUP BY c.name\nORDER BY total_order_value DESC\nLIMIT 3",
    "error": null
  },
  {
    "question": "What is the average order value for customers who have purchased products from multiple categories?",
    "success": true,
    "sql": "SELECT AVG(T1.order_value) \nFROM (\n    SELECT O.id, SUM(P.price * OI.quantity) AS order_value\n    FROM orders O\n    JOIN order_items OI ON O.id = OI.order_id\n    JOIN products P ON OI.product_id = P.id\n    GROUP BY O.id\n) T1\nJOIN (\n    SELECT O.id, COUNT(DISTINCT P.category) AS category_count\n    FROM orders O\n    JOIN order_items OI ON O.id = OI.order_id\n    JOIN products P ON OI.product_id = P.id\n    GROUP BY O.id\n    HAVING COUNT(DISTINCT P.category) > 1\n) T2\nON T1.id = T2.id",
    "error": null
  },
  {
    "question": "What are the top 10 products with the highest sales count for orders placed in the 'Pending' status?",
    "success": true,
    "sql": "SELECT p.id, p.name, SUM(oi.quantity) as sales_count\nFROM order_items oi\nJOIN orders o ON oi.order_id = o.id\nJOIN products p ON oi.product_id = p.id\nWHERE o.status = 'Pending'\nGROUP BY p.id, p.name\nORDER BY sales_count DESC\nLIMIT 10",
    "error": null
  },
  {
    "question": "What is the total revenue generated from orders placed by customers who have a 'Gold' loyalty status?",
    "success": false,
    "sql": "SELECT SUM(oi.quantity * p.price) \nFROM order_items oi \nJOIN orders o ON oi.order_id = o.id \nJOIN customers c ON o.customer_id = c.id \nJOIN products p ON oi.product_id = p.id \nWHERE c.status = 'Gold'",
    "error": "Persistent Error: Error: no such column: c.status"
  },
  {
    "question": "What is the average customer rating for products from the 'Fashion' category?",
    "success": false,
    "sql": "SELECT AVG(T1.rating) FROM (SELECT T2.category, T3.rating FROM order_items AS T1 INNER JOIN products AS T2 ON T1.product_id = T2.id INNER JOIN orders AS T3 ON T1.order_id = T3.id) AS T1 WHERE T1.category = 'Fashion'",
    "error": "Persistent Error: Error: no such column: T3.rating"
  },
  {
    "question": "List the top 5 customers who have placed the most orders in the last year, along with their total order value.",
    "success": true,
    "sql": "SELECT T1.customer_id, SUM(T3.price * T2.quantity) AS total_order_value\nFROM orders T1\nJOIN order_items T2 ON T1.id = T2.order_id\nJOIN products T3 ON T2.product_id = T3.id\nWHERE T1.order_date >= DATE('now', '-1 year')\nGROUP BY T1.customer_id\nORDER BY SUM(T3.price * T2.quantity) DESC\nLIMIT 5",
    "error": null
  },
  {
    "question": "What is the total number of orders placed by customers from the 'Africa' region in the last 9 months?",
    "success": true,
    "sql": "SELECT COUNT(o.id) \nFROM orders o \nJOIN customers c ON o.customer_id = c.id \nWHERE c.region = 'Africa' \nAND o.order_date >= DATE('now', '-9 months')",
    "error": null
  },
  {
    "question": "Rank the top 5 products by their total revenue generated from orders placed in the last 6 months.",
    "success": true,
    "sql": "SELECT product_id, SUM(quantity * price) AS total_revenue\nFROM order_items\nJOIN orders ON order_items.order_id = orders.id\nJOIN products ON order_items.product_id = products.id\nWHERE orders.order_date >= DATE('now', '-6 months')\nGROUP BY product_id\nORDER BY total_revenue DESC\nLIMIT 5",
    "error": null
  },
  {
    "question": "What is the average order value for customers who have purchased products from the 'Electronics' category?",
    "success": true,
    "sql": "SELECT AVG(T1.total_order_value) \nFROM (\n    SELECT O.id, SUM(P.price * OI.quantity) AS total_order_value\n    FROM orders O\n    JOIN order_items OI ON O.id = OI.order_id\n    JOIN products P ON OI.product_id = P.id\n    WHERE P.category = 'Electronics'\n    GROUP BY O.id\n) T1",
    "error": null
  },
  {
    "question": "What are the top 3 customers who have spent the most on products from the 'Home' category?",
    "success": true,
    "sql": "SELECT T1.customer_id, SUM(T3.price * T2.quantity) AS total_spent\nFROM orders AS T1\nJOIN order_items AS T2 ON T1.id = T2.order_id\nJOIN products AS T3 ON T2.product_id = T3.id\nWHERE T3.category = 'Home'\nGROUP BY T1.customer_id\nORDER BY total_spent DESC\nLIMIT 3",
    "error": null
  },
  {
    "question": "What is the total revenue generated from orders placed by customers who have a 'Silver' loyalty status?",
    "success": false,
    "sql": "SELECT SUM(oi.quantity * p.price) \nFROM order_items oi \nJOIN orders o ON oi.order_id = o.id \nJOIN customers c ON o.customer_id = c.id \nJOIN products p ON oi.product_id = p.id \nWHERE c.status = 'Silver'",
    "error": "Persistent Error: Error: no such column: c.status"
  },
  {
    "question": "What is the average customer rating for products from the 'Electronics' category?",
    "success": false,
    "sql": "SELECT AVG(T2.rating) FROM products AS T1 INNER JOIN order_items AS T2 ON T1.id = T2.product_id INNER JOIN orders AS T3 ON T2.order_id = T3.id WHERE T1.category = 'Electronics'",
    "error": "Persistent Error: Error: no such column: T2.rating"
  },
  {
    "question": "List the top 10 products with the highest sales count for orders placed in the 'Shipped' status.",
    "success": true,
    "sql": "SELECT p.id, p.name, SUM(oi.quantity) as sales_count\nFROM order_items oi\nJOIN orders o ON oi.order_id = o.id\nJOIN products p ON oi.product_id = p.id\nWHERE o.status = 'Shipped'\nGROUP BY p.id, p.name\nORDER BY sales_count DESC\nLIMIT 10",
    "error": null
  },
  {
    "question": "What is the total number of orders placed by customers from the 'Europe' region in the last 3 months?",
    "success": true,
    "sql": "SELECT COUNT(o.id) \nFROM orders o \nJOIN customers c ON o.customer_id = c.id \nWHERE c.region = 'Europe' \nAND o.order_date >= DATE('now', '-3 month')",
    "error": null
  },
  {
    "question": "Rank the top 10 products by their average customer rating for orders placed in the last 9 months.",
    "success": false,
    "sql": "SELECT product_id, AVG(rating) as average_rating \nFROM order_items \nJOIN orders ON order_items.order_id = orders.id \nWHERE orders.order_date > DATE('now', '-9 months') \nGROUP BY product_id \nORDER BY average_rating DESC \nLIMIT 10",
    "error": "Persistent Error: Error: no such column: rating"
  }
]